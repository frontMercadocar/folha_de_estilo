$(function() {
    window.PIE && $("*").each(function() {
        PIE.attach(this);
    });
})(function(document, window, index) {
    var inputs = document.querySelectorAll(".inputfile");
    Array.prototype.forEach.call(inputs, function(input) {
        var label = input.nextElementSibling, labelVal = label.innerHTML;
        input.addEventListener("change", function(e) {
            var fileName = "";
            fileName = this.files && this.files.length > 1 ? (this.getAttribute("data-multiple-caption") || "").replace("{count}", this.files.length) : e.target.value.split("\\").pop(), 
            fileName ? label.querySelector("span").innerHTML = fileName : label.innerHTML = labelVal;
        }), input.addEventListener("focus", function() {
            input.classList.add("has-focus");
        }), input.addEventListener("blur", function() {
            input.classList.remove("has-focus");
        });
    });
}(document, window, 0));